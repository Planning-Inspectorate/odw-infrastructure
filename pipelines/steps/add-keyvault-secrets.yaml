parameters:
  env: ''
  pythonVersion: ''

steps:
  - script: |
      set -x
      python${{ parameters.pythonVersion }} --version
      export PYTHONPATH="${PYTHONPATH}:/./"
      python${{ parameters.pythonVersion }} -m pip install "git+https://github.com/Planning-Inspectorate/odw-common.git@main"
      python${{ parameters.pythonVersion }} $(System.DefaultWorkingDirectory)/pipelines/scripts/set_keyvault_secrets.py -kvn "pinskvsynwodw${{ parameters.env }}uks"
      if [ $? -eq 1 ]; then
          echo "##vso[task.logissue type=error]set_keyvault_secrets.py failed"
          exit 1
      fi
    displayName: 'Add keyvault secrets'
    name: AddKeyVaultSecrets
